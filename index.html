<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clash Royale Deck Builder</title>
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  } 

  body {
    font-family: sans-serif;
background: linear-gradient(135deg, #5a1c97 0%, white 100%);
    min-height: 100vh;
  }

  /*navigation bar to make our website look nicer*/
  nav {
    background: rgba(255, 255, 255, 0.95);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    padding: 0;
    position: sticky;
    top: 0;
    z-index: 1000;
  }

  .nav-container {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 30px;
  }

  .nav-brand {
    font-size: 1.5rem;
    font-weight: bold;
    color: #667eea;
    text-decoration: none;
  }

  .nav-links {
    display: flex;
    gap: 30px;
    list-style: none;
  }

  .nav-links a {
    text-decoration: none;
    color: #333;
    font-weight: 500;
    padding: 8px 16px;
    border-radius: 5px;
    transition: all 0.3s ease;
  }

  .nav-links a:hover {
    background: #667eea;
    color: white;
  }

  .nav-links a.active {
    background: #667eea;
    color: white;
  }

  .sign-in-btn {
    background: #667eea;
    color: white !important;
    padding: 10px 20px !important;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
  }

  .sign-in-btn:hover {
    background: #5568d3;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  .container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 30px 20px;
    background: white;
    margin-top: 20px;
    margin-bottom: 10px;
    border-radius: 10px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  }

  h1, h2, h3 {
    text-align: center;
  }

  h1 {
    color: #667eea;
    font-size: 2.5rem;
    margin-bottom: 10px;
  }

  h2 {
    color: #666;
    font-size: 1.2rem;
    margin-bottom: 30px;
  }

  h3 {
    color: #667eea;
    font-size: 1.8rem;
    margin-bottom: 20px;
    margin-top: 30px;
  }

  #deck-rating {
    text-align: center;
    font-size: 1.2rem;
    font-weight: bold;
    margin-bottom: 5px;
    color: #667eea;
  }

  /* NEW â€” Elixir counter */
  #avg-elixir {
    text-align: center;
    font-size: 1.1rem;
    margin-bottom: 10px;
    font-weight: bold;
    color: #764ba2;
  }

  #megaknight-warning {
    text-align: center;
    font-weight: bold;
    color: red;
    margin-bottom: 20px;
    visibility: hidden;
    font-size: 1.1rem;
  }

  #deck-slots {
    display: flex;
    justify-content: center;
    gap: 12px;
    background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    padding: 20px;
    border-radius: 10px;
    margin-bottom: 20px;
  }

  .slot {
    width: 80px;
    height: 120px;
    border: 2px dashed #aaa;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    cursor: pointer;
    background: white;
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .slot:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  }

  .slot.evo {
    border: 4px solid rgb(140, 0, 140);
    box-shadow: 0 0 15px rgba(140, 0, 140, 0.3);
  }

  .slot.evo::before {
    content: "EVO";
    position: absolute;
    color: rgba(140, 0, 140, 0.15);
    font-size: 24px;
    font-weight: bold;
    top: 40px;
    left: 8px;
    pointer-events: none;
  }

  #all-cards {
    display: grid;
    grid-template-columns: repeat(auto-fill, 80px);
    gap: 10px;
    justify-content: center;
    padding: 20px;
    background: white;
    border-radius: 10px;
  }

  .card {
    width: 80px;
    height: 120px;
    border: 2px solid #ddd;
    cursor: grab;
    position: relative;
    border-radius: 8px;
    overflow: hidden;
    transition: all 0.3s ease;
    background: white;
  }
  
  .card:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    border-color: #667eea;
  }

  .card:active {
    cursor: grabbing;
  }

  .card img, .slot img {
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  .card.used {
    opacity: 0.45;
    cursor: not-allowed;
  }

  .card.used:hover {
    opacity: 0.45;
    cursor: not-allowed;
  }

  .tooltip {
    position: fixed;
    background: rgba(0,0,0,0.8);
    color: #fff;
    padding: 4px 6px;
    font-size: 12px;
    border-radius: 4px;
    white-space: nowrap;
    z-index: 10;
    pointer-events: none;
    opacity: 0;
    transition: opacity 0.05s;
  }

  #filter-container {
    text-align: center;
    margin-bottom: 10px;
  }

  #filter-container label {
    font-weight: 600;
    color: #333;
    margin-right: 10px;
  }

  #filter-container select {
    padding: 8px 16px;
    border: 2px solid #ddd;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
    background: white;
    transition: all 0,3s ease;
  }

  #filter-container select:hover{
    border-color: #667eea;
  }

  #filter-container select:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }

  /*modal for coming soon*/
  .modal {
    display: none;
    position: fixed;
    z-index: 2000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
  }

  .modal-content {
    background-color: white;
    margin: 15% auto;
    padding: 30px;
    border-radius: 10px;
    width: 80%;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
  }

.modal-content h2{
    color: #667eea;
    margin-bottom: 15px;
}

.modal-content p {
    color: #666;
    margin-top: 20px;

}

.close-btn {
    background: #667eea;
    color: white;
    padding: 10px 30px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: 600;
    transition: all 0.3s ease;
}

.close-btn:hover{
    background: #5568d3;
}
/*responsive design*/
@media (max-width: 768px){
    .nav-links {
        gap: 15px;
        font-size: 14px;
    }

    #deck-slots {
        gap: 8px;
        padding: 15px;
    }

    .slot{
        width: 60px;
        height: 90px;
    }

    .card {
        width: 60px;
        height: 90px;
    }

    h1 {
        font-size: 2rem;
    }
}
</style>
</head>
<body>

<!--nav bar-->
<nav>
    <div class="nav-container">
        <a href="#" class="nav-brand">Clash Royale Deck Builder</a>
        <ul class="nav-links">
            <li><a href="#" class="active">Deck Builder</a></li>
            <li><a href="#" class="coming-soon">Best Decks</a></li>
            <li><a href="#" class="coming-soon">Saved Decks</a></li>
            <li><a href="#" class="coming-soon">Card Stats</a></li>
            <li><a href="#" class="sign-in-btn coming-soon">Sign In</a></li>
        </ul>
    </div>
</nav>

<!--main content-->
<div class="container">
<h1>Clash Royale Deck Builder</h1>

<div id="megaknight-warning">Really? You wanna add Mega Knight?</div>
<div id="deck-rating">Deck Rating: N/A</div>
<div id="avg-elixir">Average Elixir: N/A</div>

<div id="deck-slots">
  <div class="slot" data-index="0"></div>
  <div class="slot" data-index="1"></div>
  <div class="slot evo" data-index="2"></div>
  <div class="slot evo" data-index="3"></div>
  <div class="slot" data-index="4"></div>
  <div class="slot" data-index="5"></div>
  <div class="slot" data-index="6"></div>
  <div class="slot" data-index="7"></div>
</div>

<h3>All Cards</h3>
<div id="filter-container">
  <label for="card-filter">Filter: </label>
  <select id="card-filter">
    <option value="all">All</option>
    <option value="ground">Ground</option>
    <option value="air">Air</option>
  </select>
</div>
<div id="all-cards"></div>
</div>

<!--coming ssoon-->
<div id="comingSoonModal" class="modal">
    <div class="modal-content">
        <h2>Coming Soon!</h2>
        <p>This feature is currently under development and will be availiable soon.</p>
        <button class="close-btn" onclick="closeModal()">Got it!</button>
    </div>
</div>

<script>
let deck = new Array(8).fill(null);
let cardMap = {};
let allCards = [];
let tooltip = null;

fetch("cards-data.json")
  .then(res => res.json())
  .then(data => {
    allCards = data.items;
    allCards.forEach(c => cardMap[c.name] = c);
    renderCards();
  })
  .catch(err => console.error("Error loading card data:", err));

function renderCards(filter="all") {
  const allCardsDiv = document.getElementById("all-cards");
  allCardsDiv.innerHTML = "";
  allCards
    .filter(c => filter === "all" || c.type === filter)
    .forEach(card => {
      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `<img src="${card.iconUrls.medium}" title="${card.name}" draggable="true">`;
      allCardsDiv.appendChild(div);

      div.addEventListener("click", () => addCard(card));

      div.addEventListener("dragstart", e => {
        e.dataTransfer.setData("text/plain", card.name);
      });

      div.addEventListener("mouseenter", e => showTooltip(card, e));
      div.addEventListener("mousemove", e => moveTooltip(e));
      div.addEventListener("mouseleave", hideTooltip);
    });

  allCardsDiv.querySelectorAll(".card").forEach(div => {
    const name = div.querySelector("img").title;
    div.classList.toggle("used", deck.some(c => c && c.name === name));
  });
}

document.getElementById("card-filter").addEventListener("change", e => {
  renderCards(e.target.value);
});

// Tooltip functions
function showTooltip(card, e) {
  if (tooltip) tooltip.remove();
  tooltip = document.createElement("div");
  tooltip.className = "tooltip";
  tooltip.innerText = `${card.name}\nElixir: ${card.elixirCost}\nRarity: ${card.rarity}`;
  document.body.appendChild(tooltip);
  moveTooltip(e);
  tooltip.style.opacity = 1;
}

function moveTooltip(e) {
  if (!tooltip) return;
  const padding = 10;
  const rect = tooltip.getBoundingClientRect();
  let x = e.clientX + padding;
  let y = e.clientY + padding;
  if (x + rect.width > window.innerWidth) x = e.clientX - rect.width - padding;
  if (y + rect.height > window.innerHeight) y = e.clientY - rect.height - padding;
  tooltip.style.left = x + "px";
  tooltip.style.top = y + "px";
}

function hideTooltip() { if (tooltip) { tooltip.remove(); tooltip = null; } }

const deckSlots = document.querySelectorAll(".slot");
deckSlots.forEach((slot, i) => {
  slot.addEventListener("click", () => { if(deck[i]) { deck[i]=null; renderDeck(); } });
  slot.addEventListener("dragover", e => e.preventDefault());
  slot.addEventListener("drop", e => {
    e.preventDefault();
    const name = e.dataTransfer.getData("text/plain");
    const card = cardMap[name];
    if (!deck.includes(card)) { deck[i] = card; renderDeck(); }
  });
});

function addCard(card) {
  if (deck.includes(card)) return;
  const idx = deck.findIndex(s => s === null);
  if (idx === -1) return;
  deck[idx] = card;
  renderDeck();
}

// Deck rendering
function renderDeck() {
  deckSlots.forEach((slot, i) => {
    slot.innerHTML = "";
    const card = deck[i];
    if (!card) return;

    const img = document.createElement("img");
    img.src = slot.classList.contains("evo") && card.iconUrls.evolutionMedium
      ? card.iconUrls.evolutionMedium
      : card.iconUrls.medium;
    slot.appendChild(img);

    slot.onmouseenter = e => { showTooltip(card, e); };
    slot.onmousemove = e => moveTooltip(e);
    slot.onmouseleave = hideTooltip;
  });

  document.querySelectorAll(".card").forEach(div => {
    const name = div.querySelector("img").title;
    div.classList.toggle("used", deck.some(c => c && c.name === name));
  });

  updateRating();
  updateAverageElixir();
  checkMegaKnight();
}

// Deck rating
function updateRating() {
  const ratingEl = document.getElementById("deck-rating");
  if (deck.some(s => s===null)) { ratingEl.textContent = "Deck Rating: Incomplete"; return; }
  const score = 50 + Math.floor(Math.random()*51);
  ratingEl.textContent = "Deck Rating: "+score+"/100";
}

/*Average Elixir calculation*/
function updateAverageElixir() {
  const avgElixirEl = document.getElementById("avg-elixir");

  const filled = deck.filter(c => c !== null);
  if (filled.length === 0) {
    avgElixirEl.textContent = "Average Elixir: N/A";
    return;
  }

  const total = filled.reduce((sum, c) => sum + c.elixirCost, 0);
  const avg = (total / filled.length).toFixed(1);

  avgElixirEl.textContent = "Average Elixir: " + avg;
}

function checkMegaKnight() {
  const mk = deck.some(c => c && c.name.toLowerCase()==="mega knight");
  document.getElementById("megaknight-warning").style.visibility = mk ? "visible" : "hidden";
}

const modal = document.getElementById("comingSoonModal")

document.querySelectorAll(".coming-soon").forEach(link => {
    link.addEventListener("click", (e) => {
        e.preventDefault();
        modal.style.display = "block";
    });
});

function closeModal() {
    modal.style.display = "none";
}

window.addEventListener("click", (e) => {
    if (e.target === modal){
        modal.style.display = "none"
    }
});
</script>
</body>
</html>
